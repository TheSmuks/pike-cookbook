"use strict";(self.webpackChunkpike_cookbook=self.webpackChunkpike_cookbook||[]).push([[963],{8453(n,e,t){t.d(e,{R:()=>i,x:()=>a});var o=t(6540);const r={},s=o.createContext(r);function i(n){const e=o.useContext(s);return o.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:i(n.components),o.createElement(s.Provider,{value:e},n.children)}},8711(n,e,t){t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"network/internet-services","title":"Internet Services","description":"Simple DNS Lookups","source":"@site/docs/network/internet-services.md","sourceDirName":"network","slug":"/network/internet-services","permalink":"/pike-cookbook/docs/network/internet-services","draft":false,"unlisted":false,"editUrl":"https://github.com/smuks/pike-cookbook/tree/main/docs/network/internet-services.md","tags":[],"version":"current","frontMatter":{"id":"internet-services","title":"Internet Services","sidebar_label":"Internet Services"},"sidebar":"tutorialSidebar","previous":{"title":"Web Automation","permalink":"/pike-cookbook/docs/network/web-automation"},"next":{"title":"Classes and Objects","permalink":"/pike-cookbook/docs/advanced/classes"}}');var r=t(4848),s=t(8453);const i={id:"internet-services",title:"Internet Services",sidebar_label:"Internet Services"},a="18. Internet Services",c={},l=[{value:"Simple DNS Lookups",id:"simple-dns-lookups",level:2},{value:"Being an FTP Client",id:"being-an-ftp-client",level:2}];function d(n){const e={code:"code",h1:"h1",h2:"h2",header:"header",pre:"pre",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"18-internet-services",children:"18. Internet Services"})}),"\n",(0,r.jsx)(e.h2,{id:"simple-dns-lookups",children:"Simple DNS Lookups"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-pike",children:'// Recipe 18.1: DNS Lookups with Protocols.DNS - Pike 8\n//--------------------------------------------------------------------------\n\nimport Protocols.DNS;\nimport Standards.DNS;\n\n// Basic A record lookup (hostname to IP)\nasync void lookup_a(string hostname) {\n    object client = Protocols.DNS.client();\n    array(string) ips = [array](client->getaddrbyname(hostname));\n\n    foreach(ips; string ip) {\n        write("%s -> %s\\n", hostname, ip);\n    }\n}\n\n// Reverse DNS lookup (IP to hostname)\nasync void lookup_ptr(string ip) {\n    object client = Protocols.DNS.client();\n    string hostname = client->getnamebyaddr(ip);\n    write("%s -> %s\\n", ip, hostname);\n}\n\n// MX record lookup (mail servers)\nasync void lookup_mx(string domain) {\n    object client = Protocols.DNS.client();\n    mapping(string:mixed) result = client->lookup(\n        domain, Protocol.DNS.MX\n    );\n\n    if(result->rcode == Protocol.DNS.NOERROR) {\n        write("MX records for %s:\\n", domain);\n        foreach(result->an; mapping rr) {\n            if(rr->type == Protocol.DNS.MX) {\n                write("  Priority %d: %s\\n", rr->preference, rr->exchange);\n            }\n        }\n    }\n}\n\n// TXT record lookup (DKIM, SPF, verification records)\nasync void lookup_txt(string domain) {\n    object client = Protocols.DNS.client();\n    mapping(string:mixed) result = client->lookup(\n        domain, Protocol.DNS.TXT\n    );\n\n    if(result->rcode == Protocol.DNS.NOERROR) {\n        write("TXT records for %s:\\n", domain);\n        foreach(result->an; mapping rr) {\n            if(rr->type == Protocol.DNS.TXT) {\n                write("  %s\\n", rr->txt);\n            }\n        }\n    }\n}\n\n// AAAA record lookup (IPv6 addresses)\nasync void lookup_aaaa(string hostname) {\n    object client = Protocols.DNS.client();\n    mapping(string:mixed) result = client->lookup(\n        hostname, Protocol.DNS.AAAA\n    );\n\n    if(result->rcode == Protocol.DNS.NOERROR) {\n        write("IPv6 addresses for %s:\\n", hostname);\n        foreach(result->an; mapping rr) {\n            if(rr->type == Protocol.DNS.AAAA) {\n                write("  %s\\n", rr->ipv6);\n            }\n        }\n    }\n}\n\n// Async DNS queries with Future\nasync void async_lookup(string hostname) {\n    object client = Protocols.DNS.async_client();\n    Future(array(string)) future = client->getaddrbyname(hostname);\n    array(string) ips = await future;\n\n    write("Resolved %s: %s\\n", hostname, ips*", ");\n}\n\n// Concurrent lookups\nasync void concurrent_lookups(array(string) hostnames) {\n    array(Future) futures = map(hostnames, lambda(string host) {\n        object client = Protocols.DNS.async_client();\n        return client->getaddrbyname(host);\n    });\n\n    array(array(string)) results = await Future.all(futures);\n    foreach(results; int i; array(string) ips) {\n        write("%s -> %s\\n", hostnames[i], ips*", ");\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h2,{id:"being-an-ftp-client",children:"Being an FTP Client"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-pike",children:'// Recipe 18.2: FTP Operations with Protocols.FTP - Pike 8\n//--------------------------------------------------------------------------\n\nimport Protocols.FTP;\n\n// Basic FTP connection and file download\nasync void ftp_download(string host, string user, string pass,\n                          string remote_file, string local_path) {\n    object ftp = Protocols.FTP.client();\n\n    // Connect and authenticate\n    int result = await(ftp->connect(host));\n    if (result != 220) {\n        werror("FTP connection failed: %d\\n", result);\n        return;\n    }\n\n    result = await(ftp->login(user, pass));\n    if (result != 230) {\n        werror("FTP login failed: %d\\n", result);\n        return;\n    }\n\n    // Download file\n    string data = await(ftp->get(remote_file));\n    if (data) {\n        object f = Stdio.File(local_path, "wct");\n        f->write(data);\n        f->close();\n        write("Downloaded %s to %s\\n", remote_file, local_path);\n    }\n\n    ftp->close();\n}\n\n// Upload file to FTP server\nasync void ftp_upload(string host, string user, string pass,\n                        string local_file, string remote_path) {\n    object ftp = Protocols.FTP.client();\n    await(ftp->connect(host));\n    await(ftp->login(user, pass));\n\n    // Read local file\n    string data = Stdio.read_file(local_file);\n\n    // Upload to server\n    int result = await(ftp->put(remote_path, data));\n    if (result == 226) {\n        write("Uploaded %s to %s\\n", local_file, remote_path);\n    }\n\n    ftp->close();\n}\n'})})]})}function p(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}}}]);