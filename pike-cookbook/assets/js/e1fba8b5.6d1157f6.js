"use strict";(self.webpackChunkpike_cookbook=self.webpackChunkpike_cookbook||[]).push([[577],{2746(n,e,t){t.r(e),t.d(e,{assets:()=>o,contentTitle:()=>c,default:()=>p,frontMatter:()=>s,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"advanced/classes","title":"Classes and Objects","description":"Introduction","source":"@site/docs/advanced/classes.md","sourceDirName":"advanced","slug":"/advanced/classes","permalink":"/pike-cookbook/docs/advanced/classes","draft":false,"unlisted":false,"editUrl":"https://github.com/smuks/pike-cookbook/tree/main/docs/advanced/classes.md","tags":[],"version":"current","frontMatter":{"id":"classes","title":"Classes and Objects","sidebar_label":"Classes and Objects"},"sidebar":"tutorialSidebar","previous":{"title":"Internet Services","permalink":"/pike-cookbook/docs/network/internet-services"},"next":{"title":"References and Records","permalink":"/pike-cookbook/docs/advanced/references"}}');var i=t(4848),r=t(8453);const s={id:"classes",title:"Classes and Objects",sidebar_label:"Classes and Objects"},c=void 0,o={},l=[{value:"Introduction",id:"introduction",level:2},{value:"Constructing an Object",id:"constructing-an-object",level:2},{value:"Destroying an Object",id:"destroying-an-object",level:2},{value:"Managing Instance Data",id:"managing-instance-data",level:2},{value:"Managing Class Data",id:"managing-class-data",level:2},{value:"Using Classes as Structs",id:"using-classes-as-structs",level:2},{value:"Cloning Objects",id:"cloning-objects",level:2},{value:"Calling Methods Indirectly",id:"calling-methods-indirectly",level:2},{value:"Determining Subclass Membership",id:"determining-subclass-membership",level:2},{value:"Writing an Inheritable Class",id:"writing-an-inheritable-class",level:2},{value:"Accessing Overridden Methods",id:"accessing-overridden-methods",level:2},{value:"Generating Attribute Methods Using AUTOLOAD",id:"generating-attribute-methods-using-autoload",level:2},{value:"Solving the Data Inheritance Problem",id:"solving-the-data-inheritance-problem",level:2},{value:"Coping with Circular Data Structures",id:"coping-with-circular-data-structures",level:2},{value:"Overloading Operators",id:"overloading-operators",level:2},{value:"Creating Magic Variables with tie",id:"creating-magic-variables-with-tie",level:2}];function d(n){const e={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsx)(e.p,{children:"Pike 8 is a modern object-oriented language with first-class support for classes, objects, inheritance, polymorphism, and encapsulation. This chapter covers Pike's object-oriented programming features including:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Class declaration and instantiation"}),"\n",(0,i.jsx)(e.li,{children:"Methods and properties with type annotations"}),"\n",(0,i.jsx)(e.li,{children:"Single and multiple inheritance"}),"\n",(0,i.jsx)(e.li,{children:"Access control and encapsulation"}),"\n",(0,i.jsx)(e.li,{children:"Operator overloading"}),"\n",(0,i.jsx)(e.li,{children:"Static members and class methods"}),"\n",(0,i.jsx)(e.li,{children:"Lambda functions and closures"}),"\n",(0,i.jsx)(e.li,{children:"Concurrent programming with objects"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["Pike 8 introduces enhanced type safety with ",(0,i.jsx)(e.code,{children:"#pragma strict_types"}),", improved syntax, and better integration with modern asynchronous patterns using ",(0,i.jsx)(e.code,{children:"Concurrent.Future"}),"."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'// Simple Person class with Pike 8 features\npragma strict_types\n\nclass Person {\n    protected string name;\n    protected int age;\n\n    void create(string name_, int age_) {\n        name = name_;\n        age = age_;\n    }\n\n    public string get_name() {\n        return name;\n    }\n\n    public string _sprintf(int type) {\n        return sprintf("Person(%s, %d)", name, age);\n    }\n}\n\n// Usage\nPerson p = Person("Alice", 30);\nwrite("%s\\n", p);  // Output: Person(Alice, 30)\n'})}),"\n",(0,i.jsx)(e.h2,{id:"constructing-an-object",children:"Constructing an Object"}),"\n",(0,i.jsxs)(e.p,{children:["Pike uses the ",(0,i.jsx)(e.code,{children:"create()"})," method as the constructor. The constructor is called automatically when you instantiate an object using the ",(0,i.jsx)(e.code,{children:"ClassName()"})," syntax."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass Employee {\n    protected string name;\n    protected int id;\n    protected float salary;\n\n    // Constructor with required parameters\n    void create(string name_, int id_, float salary_) {\n        name = name_;\n        id = id_;\n        salary = salary_;\n    }\n\n    // Constructor with default values\n    void create(string name_, int id_, void|float salary_) {\n        name = name_;\n        id = id_;\n        salary = undefinedp(salary_) ? 0.0 : salary_;\n    }\n}\n\n// Creating objects\nEmployee emp1 = Employee("Bob", 1001, 50000.0);\nEmployee emp2 = Employee("Carol", 1002);  // salary defaults to 0.0\n'})}),"\n",(0,i.jsx)(e.p,{children:"Pike 8 supports named parameters and optional parameters for more flexible constructors:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass Config {\n    protected mapping(string:string) options;\n\n    // Constructor with optional mapping parameter\n    void create(void|mapping(string:string) opts) {\n        options = opts || ([]);\n    }\n\n    public string get(string key, void|string default_) {\n        return options[key] || default_ || "";\n    }\n}\n\nConfig cfg1 = Config();\nConfig cfg2 = Config((["host": "localhost", "port": "8080"]));\n'})}),"\n",(0,i.jsx)(e.h2,{id:"destroying-an-object",children:"Destroying an Object"}),"\n",(0,i.jsxs)(e.p,{children:["Pike automatically handles object destruction through garbage collection. You can define a ",(0,i.jsx)(e.code,{children:"destroy()"})," method for cleanup when an object is garbage collected."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass DatabaseConnection {\n    protected string connection_string;\n    protected bool is_connected = false;\n\n    void create(string conn_str) {\n        connection_string = conn_str;\n        is_connected = true;\n        write("Connected to: %s\\n", conn_str);\n    }\n\n    void destroy() {\n        if (is_connected) {\n            write("Closing connection to: %s\\n", connection_string);\n            is_connected = false;\n        }\n    }\n}\n\n// Object is automatically destroyed when out of scope\nvoid test_connection() {\n    DatabaseConnection db = DatabaseConnection("postgresql://localhost/test");\n    write("Working with database...\\n");\n}  // destroy() called here\n\ntest_connection();\n'})}),"\n",(0,i.jsxs)(e.p,{children:["For explicit resource management, Pike 8 works well with ",(0,i.jsx)(e.code,{children:"Concurrent.Future"})," and scoping:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass Resource {\n    protected string name;\n\n    void create(string name_) {\n        name = name_;\n        write("Acquired: %s\\n", name);\n    }\n\n    void destroy() {\n        write("Released: %s\\n", name);\n    }\n\n    public void use() {\n        write("Using: %s\\n", name);\n    }\n}\n\n// Using a block to control lifetime\n{\n    Resource r = Resource("file.txt");\n    r->use();\n}  // r destroyed here\n'})}),"\n",(0,i.jsx)(e.h2,{id:"managing-instance-data",children:"Managing Instance Data"}),"\n",(0,i.jsx)(e.p,{children:"Instance data in Pike is managed through member variables. Use access modifiers to control visibility:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass BankAccount {\n    // Private instance data (protected visibility)\n    protected string account_number;\n    protected float balance;\n    protected string owner;\n\n    // Public constant\n    public constant OVERDRAFT_FEE = 35.0;\n\n    // Constructor\n    void create(string owner_, string acct_num) {\n        owner = owner_;\n        account_number = acct_num;\n        balance = 0.0;\n    }\n\n    // Public getter methods\n    public string get_owner() {\n        return owner;\n    }\n\n    public float get_balance() {\n        return balance;\n    }\n\n    // Public setter with validation\n    public int deposit(float amount) {\n        if (amount <= 0) {\n            return 0;  // Failure\n        }\n        balance += amount;\n        return 1;  // Success\n    }\n\n    public int withdraw(float amount) {\n        if (amount <= 0 || amount > balance) {\n            return 0;  // Failure\n        }\n        balance -= amount;\n        return 1;  // Success\n    }\n}\n\nBankAccount acct = BankAccount("Alice", "123-456");\nacct->deposit(100.0);\nacct->withdraw(50.0);\nwrite("Balance: $%.2f\\n", acct->get_balance());\n'})}),"\n",(0,i.jsx)(e.p,{children:"Pike 8 supports property-like syntax with optional type annotations:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass User {\n    private string _email;\n\n    void create(string email_) {\n        _email = validate_email(email_) ? email_ : "";\n    }\n\n    public string get_email() {\n        return _email;\n    }\n\n    public void set_email(string email) {\n        if (validate_email(email)) {\n            _email = email;\n        }\n    }\n\n    private bool validate_email(string email) {\n        return has_value(email, "@") && has_value(email, ".");\n    }\n}\n\nUser u = User("user@example.com");\nwrite("%s\\n", u->get_email());\nu->set_email("new@example.com");\n'})}),"\n",(0,i.jsx)(e.h2,{id:"managing-class-data",children:"Managing Class Data"}),"\n",(0,i.jsxs)(e.p,{children:["Static class data is shared across all instances. Use ",(0,i.jsx)(e.code,{children:"static"})," for class-level variables:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass Counter {\n    // Static class data - shared across all instances\n    static int instance_count = 0;\n    static mapping(string:int) registry = ([]);\n\n    protected string name;\n\n    void create(string name_) {\n        name = name_;\n        instance_count++;\n        registry[name_] = instance_count;\n    }\n\n    void destroy() {\n        instance_count--;\n        m_delete(registry, name);\n    }\n\n    // Static class method\n    static int get_instance_count() {\n        return instance_count;\n    }\n\n    static mapping(string:int) get_registry() {\n        return registry;\n    }\n}\n\nCounter c1 = Counter("first");\nCounter c2 = Counter("second");\nCounter c3 = Counter("third");\n\nwrite("Instances: %d\\n", Counter->get_instance_count());  // Output: 3\nwrite("Registry: %O\\n", Counter->get_registry());\n'})}),"\n",(0,i.jsxs)(e.p,{children:["Class constants are defined using ",(0,i.jsx)(e.code,{children:"constant"}),":"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass MathConstants {\n    public constant PI = 3.141592653589793;\n    public constant E = 2.718281828459045;\n    public constant GOLDEN_RATIO = 1.618033988749895;\n}\n\nwrite("PI: %f\\n", MathConstants->PI);\nwrite("E: %f\\n", MathConstants->E);\n'})}),"\n",(0,i.jsx)(e.h2,{id:"using-classes-as-structs",children:"Using Classes as Structs"}),"\n",(0,i.jsxs)(e.p,{children:["Pike classes work well as lightweight structs. Use the ",(0,i.jsx)(e.code,{children:"mapping"})," type for simple data structures, or create proper classes for type safety:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\n// Simple struct-like class\nclass Point {\n    public float x;\n    public float y;\n\n    void create(void|float x_, void|float y_) {\n        x = undefinedp(x_) ? 0.0 : x_;\n        y = undefinedp(y_) ? 0.0 : y_;\n    }\n\n    public float distance(Point other) {\n        float dx = x - other->x;\n        float dy = y - other->y;\n        return sqrt(dx*dx + dy*dy);\n    }\n}\n\nPoint p1 = Point(3.0, 4.0);\nPoint p2 = Point(0.0, 0.0);\nwrite("Distance: %f\\n", p1->distance(p2));  // Output: 5.0\n\n// Alternative: using mapping for simple structs\nmapping point = (["x": 3.0, "y": 4.0]);\nwrite("Point: (%.1f, %.1f)\\n", point->x, point->y);\n\n// Safe property access with Pike 8\nfloat? x = point->"x";  // Returns 3.0\nfloat? z = point->"z";  // Returns UNDEFINED\n\n// Safe access with default\nfloat z_safe = point->"z" || 0.0;\n'})}),"\n",(0,i.jsx)(e.p,{children:"For more complex structs, use factory functions:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\n// Record factory function\nfun make_person = lambda(string name, int age, string email) {\n    return ([\n        "name": name,\n        "age": age,\n        "email": email,\n        "created": time()\n    ]);\n};\n\nmapping(string:mixed) person = make_person("Dave", 25, "dave@example.com");\n'})}),"\n",(0,i.jsx)(e.h2,{id:"cloning-objects",children:"Cloning Objects"}),"\n",(0,i.jsx)(e.p,{children:"Pike provides several ways to clone objects. The simplest is to create a new instance with the same data:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass Widget {\n    public string name;\n    public int id;\n    public array(mixed) data;\n\n    void create(string name_, int id_) {\n        name = name_;\n        id = id_;\n        data = ({});\n    }\n\n    // Clone method\n    public Widget clone() {\n        Widget w = Widget(name, id);\n        w->data = data + ({});  // Shallow copy of array\n        return w;\n    }\n\n    // Deep clone method\n    public Widget deep_clone() {\n        Widget w = Widget(name, id);\n        w->data = copy_value(data);  // Deep copy\n        return w;\n    }\n}\n\nWidget original = Widget("gadget", 1);\noriginal->data = ({1, 2, 3});\n\nWidget shallow = original->clone();\nWidget deep = original->deep_clone();\n\noriginal->data[0] = 99;\nwrite("Original: %O\\n", original->data);  // ({99, 2, 3})\nwrite("Shallow: %O\\n", shallow->data);    // ({99, 2, 3}) - shared reference!\nwrite("Deep: %O\\n", deep->data);        // ({1, 2, 3}) - independent copy\n'})}),"\n",(0,i.jsxs)(e.p,{children:["Use ",(0,i.jsx)(e.code,{children:"copy_value()"})," for deep copying complex structures:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass Config {\n    public mapping(string:mixed) settings;\n\n    void create() {\n        settings = ([]);\n    }\n\n    // Create a deep copy\n    public Config copy() {\n        Config c = Config();\n        c->settings = copy_value(settings);\n        return c;\n    }\n}\n\nConfig config1 = Config();\nconfig1->settings = ([\n    "database": (["host": "localhost", "port": 5432]),\n    "features": ({"auth", "cache", "api"})\n]);\n\nConfig config2 = config1->copy();\nconfig2->settings->database->host = "remote";\n\nwrite("Config1 host: %s\\n", config1->settings->database->host);  // localhost\nwrite("Config2 host: %s\\n", config2->settings->database->host);  // remote\n'})}),"\n",(0,i.jsx)(e.h2,{id:"calling-methods-indirectly",children:"Calling Methods Indirectly"}),"\n",(0,i.jsx)(e.p,{children:"Pike supports several ways to call methods indirectly, including function references and the arrow operator:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass Calculator {\n    public float add(float a, float b) { return a + b; }\n    public float subtract(float a, float b) { return a - b; }\n    public float multiply(float a, float b) { return a * b; }\n    public float divide(float a, float b) { return a / b; }\n}\n\nCalculator calc = Calculator();\n\n// Direct method call\nfloat result1 = calc->add(5.0, 3.0);\n\n// Method reference\nfun add_ref = calc->add;\nfloat result2 = add_ref(5.0, 3.0);\n\n// Dynamic method name\nstring method_name = "multiply";\nfun method = calc[method_name];\nfloat result3 = method(5.0, 3.0);\n\n// Using call_function\nfloat result4 = call_function(calc->subtract, 5.0, 3.0);\n'})}),"\n",(0,i.jsx)(e.p,{children:"For method dispatch tables, use mappings:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass CommandProcessor {\n    public void handle_create(mapping data) { write("Creating: %O\\n", data); }\n    public void handle_update(mapping data) { write("Updating: %O\\n", data); }\n    public void handle_delete(mapping data) { write("Deleting: %O\\n", data); }\n    public void handle_default(mapping data) { write("Unknown: %O\\n", data); }\n\n    // Dispatch table\n    private mapping(string:fun) handlers;\n\n    void create() {\n        handlers = ([\n            "create": handle_create,\n            "update": handle_update,\n            "delete": handle_delete\n        ]);\n    }\n\n    public void process(string action, mapping data) {\n        fun handler = handlers[action] || handle_default;\n        handler(data);\n    }\n}\n\nCommandProcessor proc = CommandProcessor();\nproc->process("create", (["id": 1]));\nproc->process("update", (["id": 1, "name": "Test"]));\nproc->process("unknown", (["id": 1]));\n'})}),"\n",(0,i.jsx)(e.h2,{id:"determining-subclass-membership",children:"Determining Subclass Membership"}),"\n",(0,i.jsxs)(e.p,{children:["Use Pike's type checking system and the ",(0,i.jsx)(e.code,{children:"object_program()"})," function to determine class relationships:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass Animal {\n    public string name;\n\n    void create(string name_) {\n        name = name_;\n    }\n\n    public void speak() {\n        write("%s makes a sound\\n", name);\n    }\n}\n\nclass Dog {\n    inherit Animal;\n\n    void create(string name_) {\n        ::create(name_);\n    }\n\n    public void bark() {\n        write("%s barks!\\n", name);\n    }\n}\n\nclass Cat {\n    inherit Animal;\n\n    void create(string name_) {\n        ::create(name_);\n    }\n\n    public void meow() {\n        write("%s meows!\\n", name);\n    }\n}\n\n// Check object type\nvoid check_type(object obj) {\n    // Get the program (class) of the object\n    program p = object_program(obj);\n\n    write("Object type: %s\\n", master()->describe_program(p));\n\n    // Check inheritance\n    if (object_program(obj) == Dog) {\n        write("This is a Dog\\n");\n    } else if (object_program(obj) == Cat) {\n        write("This is a Cat\\n");\n    }\n\n    // Check if object inherits from Animal\n    if (Program.inherits(object_program(obj), Animal)) {\n        write("This is an Animal\\n");\n    }\n}\n\nAnimal generic = Animal("Creature");\nDog dog = Dog("Buddy");\nCat cat = Cat("Whiskers");\n\ncheck_type(generic);\ncheck_type(dog);\ncheck_type(cat);\n'})}),"\n",(0,i.jsxs)(e.p,{children:["Use ",(0,i.jsx)(e.code,{children:"catch()"})," for safe type-based dispatch:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nvoid handle_animal(Animal animal) {\n    // Try to call Dog-specific method\n    if (catch {\n        (Dog)animal->bark();\n        write("Handled as Dog\\n");\n    }) {\n        write("Not a Dog\\n");\n    }\n\n    // Or use object_program check\n    if (object_program(animal) == Dog) {\n        (Dog)animal->bark();\n    }\n}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"writing-an-inheritable-class",children:"Writing an Inheritable Class"}),"\n",(0,i.jsxs)(e.p,{children:["Pike supports single and multiple inheritance using the ",(0,i.jsx)(e.code,{children:"inherit"})," keyword. Base classes should be designed with protected methods that can be overridden:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass Shape {\n    protected string name;\n\n    void create(string name_) {\n        name = name_;\n    }\n\n    // Virtual method - to be overridden\n    public float area() {\n        return 0.0;\n    }\n\n    public float perimeter() {\n        return 0.0;\n    }\n\n    // Template method\n    public void describe() {\n        write("%s: area=%.2f, perimeter=%.2f\\n",\n              name, area(), perimeter());\n    }\n}\n\nclass Rectangle {\n    inherit Shape;\n\n    protected float width;\n    protected float height;\n\n    void create(float w, float h) {\n        ::create("Rectangle");\n        width = w;\n        height = h;\n    }\n\n    public float area() {\n        return width * height;\n    }\n\n    public float perimeter() {\n        return 2 * (width + height);\n    }\n}\n\nclass Circle {\n    inherit Shape;\n\n    protected float radius;\n\n    void create(float r) {\n        ::create("Circle");\n        radius = r;\n    }\n\n    public float area() {\n        return Math.PI * radius * radius;\n    }\n\n    public float perimeter() {\n        return 2 * Math.PI * radius;\n    }\n}\n\narray(Shape) shapes = ({\n    Rectangle(5.0, 3.0),\n    Circle(2.5),\n    Rectangle(10.0, 4.0)\n});\n\nforeach(shapes; int i; Shape shape) {\n    shape->describe();\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"Multiple inheritance in Pike:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass Drawable {\n    public void draw() {\n        write("Drawing...\\n");\n    }\n}\n\nclass Serializable {\n    public string serialize() {\n        return "serialized data";\n    }\n\n    public void deserialize(string data) {\n        write("Deserializing: %s\\n", data);\n    }\n}\n\nclass Sprite {\n    inherit Drawable;\n    inherit Serializable;\n\n    protected int x = 0;\n    protected int y = 0;\n\n    public void move(int dx, int dy) {\n        x += dx;\n        y += dy;\n        write("Moved to (%d, %d)\\n", x, y);\n    }\n}\n\nSprite sprite = Sprite();\nsprite->draw();\nsprite->move(10, 20);\nwrite("%s\\n", sprite->serialize());\n'})}),"\n",(0,i.jsx)(e.h2,{id:"accessing-overridden-methods",children:"Accessing Overridden Methods"}),"\n",(0,i.jsxs)(e.p,{children:["Use the scope resolution operator ",(0,i.jsx)(e.code,{children:"::"})," to call overridden methods from parent classes:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass Vehicle {\n    protected string make;\n    protected string model;\n\n    void create(string make_, string model_) {\n        make = make_;\n        model = model_;\n        write("Vehicle created: %s %s\\n", make, model);\n    }\n\n    public string get_info() {\n        return sprintf("%s %s", make, model);\n    }\n\n    public void start() {\n        write("Vehicle starting...\\n");\n    }\n}\n\nclass Car {\n    inherit Vehicle;\n\n    protected int num_doors;\n\n    void create(string make_, string model_, int doors) {\n        ::create(make_, model_);  // Call parent constructor\n        num_doors = doors;\n    }\n\n    // Override and extend\n    public string get_info() {\n        // Call parent method and extend\n        return ::get_info() + sprintf(" (%d doors)", num_doors);\n    }\n\n    // Override with completely different behavior\n    public void start() {\n        write("Car engine roaring!\\n");\n    }\n}\n\nCar car = Car("Toyota", "Camry", 4);\nwrite("%s\\n", car->get_info());\ncar->start();\n'})}),"\n",(0,i.jsx)(e.p,{children:"With multiple inheritance, specify which parent to call:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass Logger {\n    public void log(string msg) {\n        write("[LOG] %s\\n", msg);\n    }\n}\n\nclass Validator {\n    public bool validate(string data) {\n        return sizeof(data) > 0;\n    }\n}\n\nclass DataProcessor {\n    inherit Logger;\n    inherit Validator;\n\n    public void process(string data) {\n        // Call validate from Validator parent\n        if (Validator::validate(data)) {\n            Logger::log("Processing: " + data);\n        }\n    }\n}\n\nDataProcessor proc = DataProcessor();\nproc->process("test data");\n'})}),"\n",(0,i.jsx)(e.h2,{id:"generating-attribute-methods-using-autoload",children:"Generating Attribute Methods Using AUTOLOAD"}),"\n",(0,i.jsxs)(e.p,{children:["Pike doesn't have AUTOLOAD like Perl, but you can create dynamic getters and setters using ",(0,i.jsx)(e.code,{children:"->()"})," and ",(0,i.jsx)(e.code,{children:"[]()"})," operators. For dynamic method handling, use these special methods:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass DynamicObject {\n    protected mapping(string:mixed) attributes = ([]);\n\n    // Override the [] operator for attribute access\n    mixed `[](string key) {\n        return attributes[key];\n    }\n\n    // Override the []= operator for attribute setting\n    mixed `[]=(string key, mixed value) {\n        attributes[key] = value;\n        return value;\n    }\n\n    // Override _indices to list all attributes\n    array _indices() {\n        return indices(attributes);\n    }\n\n    // Override _values to get all values\n    array _values() {\n        return values(attributes);\n    }\n\n    // Check if attribute exists\n    public bool has_attribute(string key) {\n        return has_index(attributes, key);\n    }\n}\n\nDynamicObject obj = DynamicObject();\nobj->name = "Alice";\nobj->age = 30;\nobj->email = "alice@example.com";\n\nwrite("Name: %s\\n", obj->name);\nwrite("Age: %d\\n", obj->age);\n\nforeach(indices(obj); int i; string key) {\n    write("%s: %O\\n", key, obj[key]);\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"For method generation, use a factory pattern:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass PropertyAccessor {\n    protected mapping(string:mixed) data = ([]);\n\n    void create(array(string) property_names) {\n        // Create getter and setter for each property\n        foreach(property_names; int i; string prop) {\n            data[prop] = UNDEFINED;\n        }\n    }\n\n    // Generic getter\n    public mixed get(string prop) {\n        return data[prop];\n    }\n\n    // Generic setter\n    public void set(string prop, mixed value) {\n        data[prop] = value;\n    }\n}\n\nPropertyAccessor person = PropertyAccessor(({"name", "age", "city"}));\nperson->set("name", "Bob");\nperson->set("age", 25);\nwrite("%s is %d years old\\n", person->get("name"), person->get("age"));\n'})}),"\n",(0,i.jsx)(e.h2,{id:"solving-the-data-inheritance-problem",children:"Solving the Data Inheritance Problem"}),"\n",(0,i.jsx)(e.p,{children:"When using inheritance in Pike, each class maintains its own instance data. To share data properly, design your classes with clear separation of concerns:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\n// Base class with common data\nclass Entity {\n    protected int id;\n    protected string name;\n    protected int created_at;\n\n    void create(int id_, string name_) {\n        id = id_;\n        name = name_;\n        created_at = time();\n    }\n\n    public int get_id() { return id; }\n    public string get_name() { return name; }\n}\n\n// User extends Entity with its own data\nclass User {\n    inherit Entity;\n\n    protected string email;\n    protected string password_hash;\n    protected bool is_active = true;\n\n    void create(int id_, string name_, string email_) {\n        ::create(id_, name_);\n        email = email_;\n    }\n\n    public string get_email() { return email; }\n    public bool active() { return is_active; }\n}\n\n// Product extends Entity with different data\nclass Product {\n    inherit Entity;\n\n    protected float price;\n    protected int stock_qty;\n\n    void create(int id_, string name_, float price_) {\n        ::create(id_, name_);\n        price = price_;\n        stock_qty = 0;\n    }\n\n    public float get_price() { return price; }\n    public int get_stock() { return stock_qty; }\n}\n\nUser user = User(1, "Alice", "alice@example.com");\nProduct product = Product(100, "Widget", 29.99);\n\nwrite("User: %s (%s)\\n", user->get_name(), user->get_email());\nwrite("Product: %s ($%.2f)\\n", product->get_name(), product->get_price());\n'})}),"\n",(0,i.jsx)(e.p,{children:"For complex hierarchies, use composition over inheritance:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\n// Component: Timestamps\nclass Timestamps {\n    protected int created_at;\n    protected int updated_at;\n\n    void create() {\n        created_at = time();\n        updated_at = time();\n    }\n\n    public void touch() {\n        updated_at = time();\n    }\n\n    public int get_created() { return created_at; }\n    public int get_updated() { return updated_at; }\n}\n\n// Component: Identifiable\nclass Identifiable {\n    protected int id;\n\n    public void set_id(int id_) { id = id_; }\n    public int get_id() { return id; }\n}\n\n// Main class using composition\nclass Article {\n    private Timestamps timestamps;\n    private Identifiable identifiable;\n\n    protected string title;\n    protected string content;\n\n    void create(string title_, string content_) {\n        timestamps = Timestamps();\n        identifiable = Identifiable();\n        title = title_;\n        content = content_;\n    }\n\n    // Delegate to components\n    public void set_id(int id_) { identifiable->set_id(id_); }\n    public int get_id() { return identifiable->get_id(); }\n    public void touch() { timestamps->touch(); }\n    public int get_created() { return timestamps->get_created(); }\n\n    public string get_title() { return title; }\n    public string get_content() { return content; }\n}\n\nArticle article = Article("Hello World", "My first article");\narticle->set_id(42);\nwrite("Article %d: %s\\n", article->get_id(), article->get_title());\n'})}),"\n",(0,i.jsx)(e.h2,{id:"coping-with-circular-data-structures",children:"Coping with Circular Data Structures"}),"\n",(0,i.jsx)(e.p,{children:"Circular references can prevent proper garbage collection. Use weak references or explicitly break cycles:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass Node {\n    public string name;\n    public array(Node) children = ({});\n    public Node|zero parent = 0;\n\n    void create(string name_) {\n        name = name_;\n    }\n\n    void destroy() {\n        write("Destroying node: %s\\n", name);\n    }\n\n    public void add_child(Node child) {\n        children += ({child});\n        child->parent = this;  // Creates circular reference!\n    }\n\n    // Explicitly break the cycle\n    public void cleanup() {\n        foreach(children; int i; Node child) {\n            child->parent = 0;\n        }\n        children = ({});\n    }\n}\n\n// Create a circular structure\nNode parent = Node("parent");\nNode child = Node("child");\nparent->add_child(child);\n\n// Clean up explicitly to break the cycle\nparent->cleanup();\nchild->cleanup();\n'})}),"\n",(0,i.jsxs)(e.p,{children:["Use ",(0,i.jsx)(e.code,{children:"_destruct"})," for automatic cleanup:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass GraphNode {\n    public string id;\n    public mapping(string:GraphNode) neighbors = ([]);\n\n    void create(string id_) {\n        id = id_;\n    }\n\n    void add_edge(GraphNode other) {\n        neighbors[other->id] = other;\n        other->neighbors[id] = this;\n    }\n\n    // Break all references on destruction\n    void destroy() {\n        foreach(neighbors; string nid; GraphNode node) {\n            m_delete(node->neighbors, id);\n        }\n        neighbors = ([]);\n    }\n}\n\nGraphNode a = GraphNode("A");\nGraphNode b = GraphNode("B");\na->add_edge(b);\n// Edges automatically cleaned up when nodes are destroyed\n'})}),"\n",(0,i.jsx)(e.h2,{id:"overloading-operators",children:"Overloading Operators"}),"\n",(0,i.jsxs)(e.p,{children:["Pike allows operator overloading by implementing special methods. Define operators like ",(0,i.jsx)(e.code,{children:"+"}),", ",(0,i.jsx)(e.code,{children:"=="}),", ",(0,i.jsx)(e.code,{children:"_sprintf()"}),", etc:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass Complex {\n    public float real;\n    public float imag;\n\n    void create(float r, float i) {\n        real = r;\n        imag = i;\n    }\n\n    // Overload + operator\n    public Complex `+(mixed other) {\n        if (!objectp(other) || object_program(other) != Complex)\n            error("Can only add Complex to Complex\\n");\n        return Complex(real + other->real, imag + other->imag);\n    }\n\n    // Overload - operator\n    public Complex `-(mixed other) {\n        if (!objectp(other) || object_program(other) != Complex)\n            error("Can only subtract Complex from Complex\\n");\n        return Complex(real - other->real, imag - other->imag);\n    }\n\n    // Overload * operator\n    public Complex `*(mixed other) {\n        if (!objectp(other) || object_program(other) != Complex)\n            error("Can only multiply Complex by Complex\\n");\n        // (a+bi)(c+di) = (ac-bd) + (ad+bc)i\n        float r = real * other->real - imag * other->imag;\n        float i = real * other->imag + imag * other->real;\n        return Complex(r, i);\n    }\n\n    // Overload == operator\n    public int `==(mixed other) {\n        return objectp(other) &&\n               object_program(other) == Complex &&\n               real == other->real &&\n               imag == other->imag;\n    }\n\n    // String representation\n    public string _sprintf(int type) {\n        if (type == \'O\' || type == \'s\') {\n            return sprintf("Complex(%.2f%+.2fi)", real, imag);\n        }\n        return sprintf("%O", this);\n    }\n\n    // Hash value for use in mappings\n    public int _hash() {\n        return hash_value(real) ^ hash_value(imag);\n    }\n}\n\nComplex c1 = Complex(3.0, 4.0);\nComplex c2 = Complex(1.0, 2.0);\n\nComplex sum = c1 + c2;\nComplex diff = c1 - c2;\nComplex product = c1 * c2;\n\nwrite("c1: %s\\n", c1);\nwrite("c2: %s\\n", c2);\nwrite("sum: %s\\n", sum);\nwrite("diff: %s\\n", diff);\nwrite("product: %s\\n", product);\n'})}),"\n",(0,i.jsx)(e.p,{children:"More operator overloading examples:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nclass Vector {\n    public array(float) elements;\n\n    void create(array(float) elems) {\n        elements = elems;\n    }\n\n    // Index access: v[index]\n    public float `[](int index) {\n        return elements[index];\n    }\n\n    // Index assignment: v[index] = value\n    public float `[]=(int index, float value) {\n        elements[index] = value;\n        return value;\n    }\n\n    // Sizeof: sizeof(v)\n    public int _sizeof() {\n        return sizeof(elements);\n    }\n\n    // Iteration: foreach(v; int i; float val)\n    public array _indices() {\n        return indices(elements);\n    }\n\n    public array _values() {\n        return values(elements);\n    }\n\n    // Comparison\n    public int `==(mixed other) {\n        return objectp(other) &&\n               object_program(other) == Vector &&\n               equal(elements, other->elements);\n    }\n\n    public string _sprintf(int type) {\n        return sprintf("Vector(%s)", sprintf("%O", elements));\n    }\n}\n\nVector v = Vector(({1.0, 2.0, 3.0, 4.0}));\nwrite("%s\\n", v);\nwrite("Size: %d\\n", sizeof(v));\nwrite("v[1]: %f\\n", v[1]);\n\nv[2] = 10.0;\nwrite("After v[2] = 10.0: %s\\n", v);\n\nforeach(v; int i; float val) {\n    write("v[%d] = %f\\n", i, val);\n}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"creating-magic-variables-with-tie",children:"Creating Magic Variables with tie"}),"\n",(0,i.jsxs)(e.p,{children:["Pike doesn't have Perl's ",(0,i.jsx)(e.code,{children:"tie()"})," mechanism, but you can achieve similar behavior using objects with operator overloading. Create wrapper objects that intercept all operations:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\n// Traced variable - logs all accesses\nclass TracedVariable {\n    protected mixed value;\n    protected string name;\n\n    void create(string name_, mixed initial) {\n        name = name_;\n        value = initial;\n        write("[TRACE] %s created with value: %O\\n", name, value);\n    }\n\n    // Overload cast to mixed\n    public mixed cast(program to) {\n        if (to == typeof(value)) {\n            write("[TRACE] %s read: %O\\n", name, value);\n        }\n        return value;\n    }\n\n    // Assignment\n    public mixed `=(mixed new_value) {\n        write("[TRACE] %s: %O -> %O\\n", name, value, new_value);\n        value = new_value;\n        return value;\n    }\n\n    public string _sprintf(int type) {\n        return sprintf("TracedVariable(%s: %O)", name, value);\n    }\n}\n\n// Validated variable\nclass ValidatedString {\n    protected string value;\n    protected function(string:int) validator;\n\n    void create(function(string:int) validate_, string initial) {\n        validator = validate_;\n        set(initial);\n    }\n\n    public string get() {\n        return value;\n    }\n\n    public void set(string new_value) {\n        if (!validator(new_value)) {\n            error("Invalid value: %s\\n", new_value);\n        }\n        value = new_value;\n    }\n\n    public string _sprintf(int type) {\n        return sprintf("%s", value);\n    }\n}\n\n// Email validator\nfun is_valid_email = lambda(string email) {\n    return has_value(email, "@") && sizeof(email) > 3;\n};\n\nValidatedString email = ValidatedString(is_valid_email, "user@example.com");\nwrite("Email: %s\\n", email->get());\nemail->set("admin@example.com");\n'})}),"\n",(0,i.jsx)(e.p,{children:"Create lazy-evaluated variables using closures:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\n// Lazy-evaluated value\nclass Lazy {\n    protected mixed _computed_value = UNDEFINED;\n    protected bool _computed = false;\n    protected fun _compute_fn;\n\n    void create(fun compute_fn) {\n        _compute_fn = compute_fn;\n    }\n\n    public mixed get() {\n        if (!_computed) {\n            _computed_value = _compute_fn();\n            _computed = true;\n            write("[LAZY] Computed value\\n");\n        }\n        return _computed_value;\n    }\n\n    public void reset() {\n        _computed = false;\n        _computed_value = UNDEFINED;\n    }\n}\n\n// Expensive computation\nLazy expensive_result = Lazy(lambda() {\n    write("Computing expensive result...\\n");\n    // Simulate expensive work\n    int sum = 0;\n    for (int i = 0; i < 1000000; i++) {\n        sum += i;\n    }\n    return sum;\n});\n\nwrite("First access: %d\\n", expensive_result->get());\nwrite("Second access: %d\\n", expensive_result->get());  // Cached!\n'})}),"\n",(0,i.jsxs)(e.p,{children:["For advanced integration with Pike 8's async features, use ",(0,i.jsx)(e.code,{children:"Concurrent.Future"}),":"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-pike",children:'pragma strict_types\n\nimport Concurrent.Future;\n\n// Async wrapper that returns futures\nclass AsyncCache {\n    protected mapping(string:Future) cache = ([]);\n\n    public Future get(string key, fun fetch_fn) {\n        // Return cached future if available\n        if (cache[key]) {\n            return cache[key];\n        }\n\n        // Create new future for the fetch\n        Future result = fetch_fn();\n        cache[key] = result;\n\n        // Clean up on error\n        result->on_failure(lambda(mixed err) {\n            m_delete(cache, key);\n        });\n\n        return result;\n    }\n}\n\n// Usage example\nAsyncCache cache = AsyncCache();\n\nfun fetch_user = lambda(string user_id) {\n    // Simulate async fetch\n    return Future(lambda(fun success, fun failure) {\n        // In real code, this would be an async operation\n        success(([ "id": user_id, "name": "User" + user_id ]));\n    });\n};\n\nFuture user_future = cache->get("123", fetch_user);\nuser_future->on_success(lambda(mapping user) {\n    write("Got user: %O\\n", user);\n});\n'})})]})}function p(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}},8453(n,e,t){t.d(e,{R:()=>s,x:()=>c});var a=t(6540);const i={},r=a.createContext(i);function s(n){const e=a.useContext(r);return a.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:s(n.components),a.createElement(r.Provider,{value:e},n.children)}}}]);