<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-advanced/references" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">References and Records | Pike Cookbook</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://TheSmuks.github.io/pike-cookbook/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://TheSmuks.github.io/pike-cookbook/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://TheSmuks.github.io/pike-cookbook/docs/advanced/references"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="References and Records | Pike Cookbook"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="icon" href="/pike-cookbook/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://TheSmuks.github.io/pike-cookbook/docs/advanced/references"><link data-rh="true" rel="alternate" href="https://TheSmuks.github.io/pike-cookbook/docs/advanced/references" hreflang="en"><link data-rh="true" rel="alternate" href="https://TheSmuks.github.io/pike-cookbook/docs/advanced/references" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"References and Records","item":"https://TheSmuks.github.io/pike-cookbook/docs/advanced/references"}]}</script><link rel="stylesheet" href="/pike-cookbook/assets/css/styles.7a9da498.css">
<script src="/pike-cookbook/assets/js/runtime~main.640ae0d4.js" defer="defer"></script>
<script src="/pike-cookbook/assets/js/main.c3b68af9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/pike-cookbook/"><div class="navbar__logo"><img src="/pike-cookbook/img/logo.svg" alt="Pike Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/pike-cookbook/img/logo.svg" alt="Pike Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Pike Cookbook</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/pike-cookbook/docs/intro">Cookbook</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/smuks/pike-cookbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pike-cookbook/docs/intro"><span title="Introduction" class="linkLabel_WmDU">Introduction</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/pike-cookbook/docs/basics/strings"><span title="Basic Recipes" class="categoryLinkLabel_W154">Basic Recipes</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/basics/strings"><span title="Strings" class="linkLabel_WmDU">Strings</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/basics/numbers"><span title="Numbers" class="linkLabel_WmDU">Numbers</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/basics/arrays"><span title="Arrays" class="linkLabel_WmDU">Arrays</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/basics/hashes"><span title="Hashes" class="linkLabel_WmDU">Hashes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/basics/dates"><span title="Dates and Times" class="linkLabel_WmDU">Dates and Times</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/basics/pattern-matching"><span title="Pattern Matching" class="linkLabel_WmDU">Pattern Matching</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/basics/subroutines"><span title="Subroutines" class="linkLabel_WmDU">Subroutines</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/pike-cookbook/docs/files/file-access"><span title="File Operations" class="categoryLinkLabel_W154">File Operations</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/files/file-access"><span title="File Access" class="linkLabel_WmDU">File Access</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/files/file-contents"><span title="File Contents" class="linkLabel_WmDU">File Contents</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/files/directories"><span title="Directories" class="linkLabel_WmDU">Directories</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/files/database-access"><span title="Database Access" class="linkLabel_WmDU">Database Access</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/pike-cookbook/docs/network/cgi-programming"><span title="Network &amp; Web" class="categoryLinkLabel_W154">Network &amp; Web</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/network/cgi-programming"><span title="CGI Programming" class="linkLabel_WmDU">CGI Programming</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/network/sockets"><span title="Sockets" class="linkLabel_WmDU">Sockets</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/network/web-automation"><span title="Web Automation" class="linkLabel_WmDU">Web Automation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/network/internet-services"><span title="Internet Services" class="linkLabel_WmDU">Internet Services</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/pike-cookbook/docs/advanced/classes"><span title="Advanced Topics" class="categoryLinkLabel_W154">Advanced Topics</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/advanced/classes"><span title="Classes and Objects" class="linkLabel_WmDU">Classes and Objects</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/pike-cookbook/docs/advanced/references"><span title="References and Records" class="linkLabel_WmDU">References and Records</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/advanced/modules"><span title="Modules and Packages" class="linkLabel_WmDU">Modules and Packages</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/advanced/processes"><span title="Process Management" class="linkLabel_WmDU">Process Management</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pike-cookbook/docs/advanced/user-interfaces"><span title="User Interfaces" class="linkLabel_WmDU">User Interfaces</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/pike-cookbook/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Advanced Topics</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">References and Records</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>References and Records</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction" translate="no">​</a></h2>
<p>Pike handles references differently from Perl. In Pike, arrays, mappings, and objects are always passed by reference, while basic types (int, float, string) are passed by value. Pike uses reference counting and garbage collection for automatic memory management.</p>
<div class="language-pike codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-pike codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pike 8 - Reference basics</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#pragma strict_types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Arrays are reference types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(int) arr1 = ({1, 2, 3});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(int) arr2 = arr1;  // Both point to same array</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">arr2[0] = 99;            // Modifies the shared array</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;arr1[0]: %d\n&quot;, arr1[0]);  // Output: 99</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Basic types are value types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">int x = 5;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">int y = x;     // Copy of the value</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">y = 10;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;x: %d, y: %d\n&quot;, x, y);  // Output: x: 5, y: 10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Mappings are reference types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:int) m1 = ([&quot;apple&quot;: 1]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:int) m2 = m1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">m2[&quot;apple&quot;] = 2;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;m1[\&quot;apple\&quot;]: %d\n&quot;, m1[&quot;apple&quot;]);  // Output: 2</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="taking-references-to-arrays">Taking References to Arrays<a href="#taking-references-to-arrays" class="hash-link" aria-label="Direct link to Taking References to Arrays" title="Direct link to Taking References to Arrays" translate="no">​</a></h2>
<p>In Pike, you don&#x27;t need explicit reference operators for arrays. Arrays are always reference types. For explicit reference semantics, use the ADT.Array module or store arrays in containers.</p>
<div class="language-pike codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-pike codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pike 8 - Array references</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#pragma strict_types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import ADT;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Simple array assignment creates a reference</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(string) fruits = ({&quot;apple&quot;, &quot;banana&quot;, &quot;cherry&quot;});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(string) ref = fruits;  // Reference to same array</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ref[0] = &quot;apricot&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;fruits[0]: %s\n&quot;, fruits[0]);  // Output: apricot</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Using modern ADT.Array for explicit array operations</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Array arr = Array();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">arr-&gt;push(&quot;first&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">arr-&gt;push(&quot;second&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Array contents: %s\n&quot;, arr-&gt;cast(array));  // Output: ({ &quot;first&quot;, &quot;second&quot; })</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Array of arrays (nested structures)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(array(int)) matrix = ({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ({1, 2, 3}),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ({4, 5, 6}),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ({7, 8, 9})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(int) row = matrix[0];  // Reference to first row</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">row[0] = 99;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;matrix[0][0]: %d\n&quot;, matrix[0][0]);  // Output: 99</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Safe indexing with -&gt;? operator (Pike 8)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(int) maybe_empty = ({});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">int|zero val = maybe_empty-&gt;[0];  // Safe indexing returns UNDEFINED or 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Safe access: %d\n&quot;, val);  // 0 if out of bounds</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="making-hashes-of-arrays">Making Hashes of Arrays<a href="#making-hashes-of-arrays" class="hash-link" aria-label="Direct link to Making Hashes of Arrays" title="Direct link to Making Hashes of Arrays" translate="no">​</a></h2>
<p>Pike uses mappings (hash tables) where values can be arrays. Create complex data structures by nesting arrays within mappings.</p>
<div class="language-pike codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-pike codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pike 8 - Hash of arrays</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#pragma strict_types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Mapping with array values</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:array(string)) employees = ([</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;engineering&quot;: ([&quot;alice&quot;, &quot;bob&quot;, &quot;charlie&quot;]),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;sales&quot;: ([&quot;david&quot;, &quot;eve&quot;]),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;marketing&quot;: ([&quot;frank&quot;])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Access and modify</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">employees[&quot;engineering&quot;] += ([&quot;david&quot;]);  // Add to array</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Engineering team: %s\n&quot;, employees[&quot;engineering&quot;] * &quot;, &quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Safe indexing with -&gt;?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(string)|zero dept = employees-&gt;[&quot;engineering&quot;];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if (dept) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    write(&quot;Department exists\n&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Initialize hash of arrays dynamically</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:array(int)) scores = ([]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">void add_score(string category, int score) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!scores[category]) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        scores[category] = ({});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    scores[category] += ({score});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">add_score(&quot;player1&quot;, 100);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">add_score(&quot;player1&quot;, 150);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">add_score(&quot;player2&quot;, 200);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Display all scores</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">foreach (scores; string category; array(int) arr) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    write(&quot;%s: %s\n&quot;, category, arr * &quot;, &quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="taking-references-to-hashes">Taking References to Hashes<a href="#taking-references-to-hashes" class="hash-link" aria-label="Direct link to Taking References to Hashes" title="Direct link to Taking References to Hashes" translate="no">​</a></h2>
<p>Mappings in Pike are always reference types. Assign a mapping to another variable to create a reference to the same mapping.</p>
<div class="language-pike codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-pike codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pike 8 - Mapping references</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#pragma strict_types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Mapping reference</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:int) colors = ([</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;red&quot;: 0xFF0000,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;green&quot;: 0x00FF00,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;blue&quot;: 0x0000FF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:int) ref = colors;  // Reference to same mapping</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ref[&quot;red&quot;] = 0x110000;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;colors[\&quot;red\&quot;]: %x\n&quot;, colors[&quot;red&quot;]);  // Output: 110000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Mapping of mappings</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:mapping(string:int)) user_data = ([</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;user1&quot;: ([&quot;age&quot;: 25, &quot;score&quot;: 100]),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;user2&quot;: ([&quot;age&quot;: 30, &quot;score&quot;: 150])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:int)|zero data = user_data-&gt;[&quot;user1&quot;];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if (data) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    data[&quot;score&quot;] = 200;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    write(&quot;Modified score: %d\n&quot;, user_data[&quot;user1&quot;][&quot;score&quot;]);  // Output: 200</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Copy mapping (shallow copy)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:int) copy = colors + ([]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">copy[&quot;green&quot;] = 0x001100;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Original green: %x, Copy green: %x\n&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      colors[&quot;green&quot;], copy[&quot;green&quot;]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Deep copy function</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:mapping(string:int)) deep_copy(mapping(string:mapping(string:int)) m) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    mapping(string:mapping(string:int)) result = ([]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    foreach (m; string key; mapping(string:int) val) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        result[key] = val + ([]);  // Shallow copy of inner mapping</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return result;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="taking-references-to-functions">Taking References to Functions<a href="#taking-references-to-functions" class="hash-link" aria-label="Direct link to Taking References to Functions" title="Direct link to Taking References to Functions" translate="no">​</a></h2>
<p>Pike supports first-class functions. Store functions in variables, pass them as arguments, and return them from other functions.</p>
<div class="language-pike codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-pike codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pike 8 - Function references</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#pragma strict_types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Simple function reference</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">int add(int a, int b) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return a + b;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">int multiply(int a, int b) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return a * b;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Store function in variable</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function(int,int:int) operation = add;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;5 + 3 = %d\n&quot;, operation(5, 3));  // Output: 8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Change function reference</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">operation = multiply;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;5 * 3 = %d\n&quot;, operation(5, 3));  // Output: 15</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Higher-order function</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(int) apply_op(array(int) arr, function(int:int) func) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return map(arr, func);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Lambda functions</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(int) nums = ({1, 2, 3, 4, 5});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(int) doubled = apply_op(nums, lambda(int x) { return x * 2; });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(int) squared = apply_op(nums, lambda(int x) { return x * x; });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Doubled: %s\n&quot;, doubled * &quot;, &quot;);    // Output: 2, 4, 6, 8, 10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Squared: %s\n&quot;, squared * &quot;, &quot;);    // Output: 1, 4, 9, 16, 25</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Array of functions</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(function(int,int:int)) ops = ({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    lambda(int a, int b) { return a + b; },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    lambda(int a, int b) { return a - b; },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    lambda(int a, int b) { return a * b; }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">foreach (ops; int i; function(int,int:int) op) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    write(&quot;op[%d](10, 5) = %d\n&quot;, i, op(10, 5));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="taking-references-to-scalars">Taking References to Scalars<a href="#taking-references-to-scalars" class="hash-link" aria-label="Direct link to Taking References to Scalars" title="Direct link to Taking References to Scalars" translate="no">​</a></h2>
<p>Pike doesn&#x27;t have scalar references like Perl. Instead, use containers (single-element arrays or mappings) to achieve similar behavior.</p>
<div class="language-pike codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-pike codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pike 8 - Simulating scalar references</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#pragma strict_types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Using single-element array as reference</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(int) ref = ({10});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">void modify_ref(array(int) r) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    r[0] = 20;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">modify_ref(ref);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;ref[0]: %d\n&quot;, ref[0]);  // Output: 20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Using mapping as reference</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:int) container = ([&quot;value&quot;: 100]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">void modify_container(mapping(string:int) c) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    c[&quot;value&quot;] = 200;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">modify_container(container);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;container[\&quot;value\&quot;]: %d\n&quot;, container[&quot;value&quot;]);  // Output: 200</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Return multiple values via mapping</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:mixed) divide(int a, int b) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (b == 0) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        error(&quot;Division by zero&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return ([</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;quotient&quot;: a / b,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;remainder&quot;: a % b</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:mixed) result = divide(17, 5);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;17 / 5 = %d, remainder %d\n&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      result[&quot;quotient&quot;], result[&quot;remainder&quot;]);  // Output: 17 / 5 = 3, remainder 2</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="creating-arrays-of-scalar-references">Creating Arrays of Scalar References<a href="#creating-arrays-of-scalar-references" class="hash-link" aria-label="Direct link to Creating Arrays of Scalar References" title="Direct link to Creating Arrays of Scalar References" translate="no">​</a></h2>
<p>Use arrays or mappings as container objects to create arrays of mutable references.</p>
<div class="language-pike codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-pike codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pike 8 - Arrays of container references</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#pragma strict_types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Array of single-element arrays (simulating references)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(array(int)) refs = ({});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for (int i = 0; i &lt; 5; i++) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    refs += ({ ({i}) });  // Each element is an array containing one value</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Modify through &quot;references&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">refs[0][0] = 99;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">refs[2][0] = 88;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">foreach (refs; int i; array(int) ref) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    write(&quot;refs[%d] = %d\n&quot;, i, ref[0]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Output:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// refs[0] = 99</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// refs[1] = 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// refs[2] = 88</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// refs[3] = 3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// refs[4] = 4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Practical example: updating multiple values</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(mapping(string:int)) counters = ({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ([&quot;value&quot;: 0]),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ([&quot;value&quot;: 0]),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ([&quot;value&quot;: 0])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">void increment_all(array(mapping(string:int)) counters) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    foreach (counters; int i; mapping(string:int) c) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        c[&quot;value&quot;]++;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">increment_all(counters);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Counters: %s\n&quot;, counters-&gt;value * &quot;, &quot;);  // Output: 1, 1, 1</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="using-closures-instead-of-objects">Using Closures Instead of Objects<a href="#using-closures-instead-of-objects" class="hash-link" aria-label="Direct link to Using Closures Instead of Objects" title="Direct link to Using Closures Instead of Objects" translate="no">​</a></h2>
<p>Pike supports closures through lambda functions that capture variables from their enclosing scope. Use closures for encapsulation and state management.</p>
<div class="language-pike codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-pike codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pike 8 - Closures for encapsulation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#pragma strict_types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Counter using closure</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function(int:void) create_counter(int start) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int count = start;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return lambda(int delta) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        count += delta;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        write(&quot;Count: %d\n&quot;, count);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function(int:void) counter1 = create_counter(0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function(int:void) counter2 = create_counter(100);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">counter1(1);   // Output: Count: 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">counter1(1);   // Output: Count: 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">counter2(10);  // Output: Count: 110</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">counter1(5);   // Output: Count: 7</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Getter/setter using closure</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:function) create_property(mixed initial_value) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    mixed value = initial_value;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return ([</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;get&quot;: lambda() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return value;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;set&quot;: lambda(mixed new_val) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            value = new_val;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:function) prop = create_property(&quot;initial&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Value: %s\n&quot;, prop[&quot;get&quot;]());  // Output: Value: initial</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">prop[&quot;set&quot;](&quot;modified&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Value: %s\n&quot;, prop[&quot;get&quot;]());  // Output: Value: modified</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Private state with accessors</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function(void:mixed|int|string) create_bank_account(int initial) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int balance = initial;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string owner = &quot;unknown&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return lambda(mixed|int|string|void arg) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (stringp(arg)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // Set owner</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            owner = arg;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return owner;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } else if (intp(arg)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // Deposit/withdraw</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            balance += arg;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return balance;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // Get balance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return balance;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function(mixed:int|string) account = create_bank_account(100);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Balance: %d\n&quot;, account());         // Output: Balance: 100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">account(50);                                 // Deposit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Balance: %d\n&quot;, account());         // Output: Balance: 150</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">account(&quot;Alice&quot;);                           // Set owner</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Owner: %s\n&quot;, account(&quot;check&quot;));    // This won&#x27;t work as shown, needs type checking</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="creating-references-to-methods">Creating References to Methods<a href="#creating-references-to-methods" class="hash-link" aria-label="Direct link to Creating References to Methods" title="Direct link to Creating References to Methods" translate="no">​</a></h2>
<p>Store method references in Pike using class methods and function pointers. Pike supports object-oriented programming with proper method references.</p>
<div class="language-pike codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-pike codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pike 8 - Method references</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#pragma strict_types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class Calculator {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int add(int a, int b) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return a + b;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int multiply(int a, int b) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return a * b;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int apply(function(int,int:int) op, int a, int b) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return op(a, b);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Calculator calc = Calculator();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Direct method call</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;add: %d\n&quot;, calc-&gt;add(5, 3));        // Output: add: 8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Method reference</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function(int,int:int) method = calc-&gt;add;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;method(5, 3): %d\n&quot;, method(5, 3));  // Output: method(5, 3): 8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pass method as argument</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;apply multiply: %d\n&quot;, calc-&gt;apply(calc-&gt;multiply, 4, 3));  // Output: 12</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Array of method references</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(function(int,int:int)) ops = ({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    calc-&gt;add,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    calc-&gt;multiply</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">foreach (ops; int i; function(int,int:int) op) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    write(&quot;Operation %d: 5, 3 -&gt; %d\n&quot;, i, op(5, 3));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Callback pattern</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class Processor {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    array(int) process(array(int) data, function(int:int) func) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return map(data, func);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Processor proc = Processor();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(int) numbers = ({1, 2, 3, 4, 5});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Using lambda as callback</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(int) result = proc-&gt;process(numbers, lambda(int x) { return x * 2; });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Doubled: %s\n&quot;, result * &quot;, &quot;);  // Output: 2, 4, 6, 8, 10</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="constructing-records">Constructing Records<a href="#constructing-records" class="hash-link" aria-label="Direct link to Constructing Records" title="Direct link to Constructing Records" translate="no">​</a></h2>
<p>Pike doesn&#x27;t have a dedicated &quot;record&quot; type. Use mappings or classes to create record-like structures. Classes provide type safety and methods.</p>
<div class="language-pike codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-pike codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pike 8 - Records using mappings and classes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#pragma strict_types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Simple record using mapping</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:mixed) create_person(string name, int age, string city) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return ([</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;name&quot;: name,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;age&quot;: age,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;city&quot;: city</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:mixed) person1 = create_person(&quot;Alice&quot;, 30, &quot;NYC&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:mixed) person2 = create_person(&quot;Bob&quot;, 25, &quot;LA&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;%s is %d years old\n&quot;, person1[&quot;name&quot;], person1[&quot;age&quot;]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Record using class (type-safe)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class Person {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string name;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int age;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string city;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void create(string name, int age, string city) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        this-&gt;name = name;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        this-&gt;age = age;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        this-&gt;city = city;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string get_summary() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return sprintf(&quot;%s (%d) from %s&quot;, name, age, city);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void birthday() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        age++;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Person p1 = Person(&quot;Charlie&quot;, 35, &quot;Chicago&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Person p2 = Person(&quot;Diana&quot;, 28, &quot;Boston&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Person: %s\n&quot;, p1-&gt;get_summary());  // Output: Person: Charlie (35) from Chicago</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">p1-&gt;birthday();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;After birthday: %d\n&quot;, p1-&gt;age);    // Output: After birthday: 36</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Array of records</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(Person) people = ({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Person(&quot;Eve&quot;, 22, &quot;Seattle&quot;),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Person(&quot;Frank&quot;, 40, &quot;Denver&quot;),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Person(&quot;Grace&quot;, 31, &quot;Austin&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">foreach (people; int i; Person p) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    write(&quot;%d: %s\n&quot;, i, p-&gt;get_summary());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Record with validation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class Employee {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private string _name;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private int _id;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private float _salary;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void create(string name, int id, float salary) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (salary &lt; 0) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            error(&quot;Salary cannot be negative&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _name = name;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _id = id;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _salary = salary;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string name() { return _name; }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int id() { return _id; }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    float salary() { return _salary; }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void raise(float percent) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (percent &lt; 0) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            error(&quot;Raise percent cannot be negative&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _salary *= (1.0 + percent / 100.0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Employee emp = Employee(&quot;Alice&quot;, 1001, 50000.0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">emp-&gt;raise(10.0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;New salary: %.2f\n&quot;, emp-&gt;salary());  // Output: New salary: 55000.00</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="reading-and-writing-hash-records-to-text-files">Reading and Writing Hash Records to Text Files<a href="#reading-and-writing-hash-records-to-text-files" class="hash-link" aria-label="Direct link to Reading and Writing Hash Records to Text Files" title="Direct link to Reading and Writing Hash Records to Text Files" translate="no">​</a></h2>
<p>Serialize mapping data to text files using various formats. Pike provides encode_value for binary serialization and manual methods for text formats.</p>
<div class="language-pike codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-pike codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pike 8 - Reading/writing records to files</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#pragma strict_types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">constant DATA_FILE = &quot;records.txt&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Write records as simple key-value pairs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">void write_records(array(mapping(string:string)) records, string filename) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Stdio.File file = Stdio.File();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!file-&gt;open(filename, &quot;wct&quot;)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        error(&quot;Cannot open file for writing: &quot; + strerror(file-&gt;errno()));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    foreach (records; int i; mapping(string:string) record) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        foreach (record; string key; string value) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            file-&gt;write(&quot;%s=%s\n&quot;, key, value);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        file-&gt;write(&quot;---\n&quot;);  // Record separator</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    file-&gt;close();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Read records from file</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(mapping(string:string)) read_records(string filename) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Stdio.File file = Stdio.File();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!file-&gt;open(filename, &quot;r&quot;)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        error(&quot;Cannot open file for reading: &quot; + strerror(file-&gt;errno()));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    array(mapping(string:string)) records = ({});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    mapping(string:string) current = ([]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    foreach (file-&gt;line_iterator(1); ; string line) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        line = String.trim_whites(line);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (line == &quot;&quot; || line == &quot;---&quot;) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if (sizeof(current)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                records += ({ current });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                current = ([]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            continue;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        array(string) parts = line / &quot;=&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (sizeof(parts) == 2) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            current[parts[0]] = parts[1];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (sizeof(current)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        records += ({ current });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    file-&gt;close();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return records;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Usage</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(mapping(string:string)) employees = ([</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ([&quot;name&quot;: &quot;Alice&quot;, &quot;id&quot;: &quot;1001&quot;, &quot;dept&quot;: &quot;Engineering&quot;]),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ([&quot;name&quot;: &quot;Bob&quot;, &quot;id&quot;: &quot;1002&quot;, &quot;dept&quot;: &quot;Sales&quot;]),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ([&quot;name&quot;: &quot;Charlie&quot;, &quot;id&quot;: &quot;1003&quot;, &quot;dept&quot;: &quot;Marketing&quot;])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write_records(employees, DATA_FILE);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(mapping(string:string)) loaded = read_records(DATA_FILE);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">foreach (loaded; int i; mapping(string:string) emp) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    write(&quot;Employee %d: %s (%s) - %s\n&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          i, emp[&quot;name&quot;], emp[&quot;id&quot;], emp[&quot;dept&quot;]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// JSON format (requires external module or manual encoding)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">void write_json(array(mapping(string:mixed)) data, string filename) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Stdio.File file = Stdio.File(filename, &quot;wct&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    file-&gt;write(&quot;[\n&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    foreach (data; int i; mapping(string:mixed) record) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        file-&gt;write(&quot;  {\n&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        array(string) keys = indices(record);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        foreach (keys; int j; string key) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            mixed value = record[key];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            string value_str = stringp(value) ? sprintf(&quot;\&quot;%s\&quot;&quot;, value) : sprintf(&quot;%d&quot;, value);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            file-&gt;write(&quot;    \&quot;%s\&quot;: %s%s\n&quot;, key, value_str, j &lt; sizeof(keys)-1 ? &quot;,&quot; : &quot;&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        file-&gt;write(&quot;  }%s\n&quot;, i &lt; sizeof(data)-1 ? &quot;,&quot; : &quot;&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    file-&gt;write(&quot;]\n&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    file-&gt;close();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="printing-data-structures">Printing Data Structures<a href="#printing-data-structures" class="hash-link" aria-label="Direct link to Printing Data Structures" title="Direct link to Printing Data Structures" translate="no">​</a></h2>
<p>Use Pike&#x27;s built-in functions to inspect and debug data structures. sprintf with %O provides detailed output.</p>
<div class="language-pike codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-pike codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pike 8 - Printing data structures</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#pragma strict_types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Simple arrays and mappings</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(int) nums = ({1, 2, 3, 4, 5});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:int) colors = ([&quot;red&quot;: 1, &quot;green&quot;: 2, &quot;blue&quot;: 3]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Array: %s\n&quot;, (string)nums);        // Output: Array: ({1, 2, 3, 4, 5})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Mapping: %s\n&quot;, (string)colors);     // Output: Mapping: ([&quot;blue&quot;: 3, &quot;green&quot;: 2, &quot;red&quot;: 1])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Using %O for detailed output</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Detailed array: %O\n&quot;, nums);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Detailed mapping: %O\n&quot;, colors);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pretty print function</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">string pretty_print(mixed data, int|void indent) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    indent = indent || 0;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string ind = &quot; &quot; * indent;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (arrayp(data)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        array(string) parts =({});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        parts += ({ind + &quot;({\n&quot;});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        foreach (data; int i; mixed val) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            parts += ({pretty_print(val, indent + 2)});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if (i &lt; sizeof(data) - 1) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                parts[-1] += &quot;,&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            parts[-1] += &quot;\n&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        parts += ({ind + &quot;})&quot;});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return parts * &quot;&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    } else if (mappingp(data)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        array(string) parts =({});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        parts += ({ind + &quot;([\n&quot;});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        array(string) keys = indices(data);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        foreach (keys; int i; string key) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            parts += ({sprintf(&quot;%s%s: %s&quot;, ind + &quot;  &quot;, key,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                               pretty_print(data[key], 0))});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if (i &lt; sizeof(keys) - 1) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                parts[-1] += &quot;,&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            parts[-1] += &quot;\n&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        parts += ({ind + &quot;])&quot;});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return parts * &quot;&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return sprintf(&quot;%O&quot;, data);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Complex nested structure</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:mixed) complex = ([</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;users&quot;: ({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ([&quot;name&quot;: &quot;Alice&quot;, &quot;age&quot;: 30]),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ([&quot;name&quot;: &quot;Bob&quot;, &quot;age&quot;: 25])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;settings&quot;: ([</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;theme&quot;: &quot;dark&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;notifications&quot;: true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Complex structure:\n%s\n&quot;, pretty_print(complex));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Using Stdio.File.write for formatted output</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">void debug_dump(string label, mixed data) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    write(&quot;=== %s ===\n&quot;, label);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    write(&quot;%O\n&quot;, data);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    write(&quot;===================\n\n&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">debug_dump(&quot;Numbers array&quot;, nums);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">debug_dump(&quot;Colors mapping&quot;, colors);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pretty print with indices</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">void print_with_indices(array(mixed) arr) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    foreach (arr; int i; mixed val) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        write(&quot;[%d] %O\n&quot;, i, val);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(string) fruits = ({&quot;apple&quot;, &quot;banana&quot;, &quot;cherry&quot;});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print_with_indices(fruits);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Output:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// [0] &quot;apple&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// [1] &quot;banana&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// [2] &quot;cherry&quot;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="copying-data-structures">Copying Data Structures<a href="#copying-data-structures" class="hash-link" aria-label="Direct link to Copying Data Structures" title="Direct link to Copying Data Structures" translate="no">​</a></h2>
<p>Pike provides shallow copying by default. Implement deep copy recursively for nested structures.</p>
<div class="language-pike codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-pike codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pike 8 - Copying data structures</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#pragma strict_types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Shallow copy of array</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(int) original = ({1, 2, 3});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(int) shallow = original + ({});  // Add empty array to create copy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">shallow[0] = 99;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Original[0]: %d, Shallow[0]: %d\n&quot;, original[0], shallow[0]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Output: Original[0]: 1, Shallow[0]: 99</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Shallow copy of mapping</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:int) m_original = ([&quot;a&quot;: 1, &quot;b&quot;: 2]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:int) m_shallow = m_original + ([]);  // Add empty mapping</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">m_shallow[&quot;a&quot;] = 99;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Original[&#x27;a&#x27;]: %d, Shallow[&#x27;a&#x27;]: %d\n&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      m_original[&quot;a&quot;], m_shallow[&quot;a&quot;]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Deep copy function</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mixed deep_copy(mixed data) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (arrayp(data)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        array(mixed) result =({});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        foreach (data; int i; mixed val) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            result += ({deep_copy(val)});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return result;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    } else if (mappingp(data)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        mapping(mixed:mixed) result = ([]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        foreach (data; mixed key; mixed val) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            result[deep_copy(key)] = deep_copy(val);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return result;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    } else if (multisetp(data)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        multiset(mixed) result = (&lt;&gt;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        foreach (data; mixed val; ) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            result[deep_copy(val)] = true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return result;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return data;  // Basic types are immutable</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Test deep copy with nested structure</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(array(int)) nested = ({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ({1, 2, 3}),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ({4, 5, 6})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(array(int)) nested_copy = deep_copy(nested);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">nested_copy[0][0] = 999;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Original[0][0]: %d\n&quot;, nested[0][0]);        // Output: 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Copy[0][0]: %d\n&quot;, nested_copy[0][0]);        // Output: 999</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Deep copy with complex mapping</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:mixed) complex = ([</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;numbers&quot;: ({1, 2, 3}),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;nested&quot;: ([&quot;inner&quot;: ([&quot;data&quot;: &quot;value&quot;])])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:mixed) complex_copy = deep_copy(complex);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">complex_copy[&quot;nested&quot;][&quot;inner&quot;][&quot;data&quot;] = &quot;modified&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Original data: %s\n&quot;, complex[&quot;nested&quot;][&quot;inner&quot;][&quot;data&quot;]);      // Output: value</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Copy data: %s\n&quot;, complex_copy[&quot;nested&quot;][&quot;inner&quot;][&quot;data&quot;]);    // Output: modified</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Copy-on-write pattern for arrays</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class CowArray {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private array(mixed) _data;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void create(array(mixed) initial) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _data = initial;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    array(mixed) get_data() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return _data;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void modify(int index, mixed value) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // Copy on first modification</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _data = _data + ({});  // Shallow copy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _data[index] = value;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="storing-data-structures-to-disk">Storing Data Structures to Disk<a href="#storing-data-structures-to-disk" class="hash-link" aria-label="Direct link to Storing Data Structures to Disk" title="Direct link to Storing Data Structures to Disk" translate="no">​</a></h2>
<p>Use Pike&#x27;s encode_value and decode_value for efficient binary serialization of data structures.</p>
<div class="language-pike codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-pike codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pike 8 - Storing data structures with encode_value</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#pragma strict_types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">constant DATA_FILE = &quot;datastore.dat&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Save data structure to disk</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">void save_data(mixed data, string filename) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string encoded = encode_value(data);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Stdio.File file = Stdio.File(filename, &quot;wct&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!file) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        error(&quot;Cannot open file for writing&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    file-&gt;write(encoded);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    file-&gt;close();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    write(&quot;Saved data to %s (%d bytes)\n&quot;, filename, sizeof(encoded));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Load data structure from disk</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mixed load_data(string filename) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Stdio.File file = Stdio.File(filename, &quot;r&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!file) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        error(&quot;Cannot open file for reading&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string encoded = file-&gt;read();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    file-&gt;close();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    mixed data = decode_value(encoded);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    write(&quot;Loaded data from %s\n&quot;, filename);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return data;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Complex data structure</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:mixed) app_data = ([</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;version&quot;: &quot;1.0&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;users&quot;: ({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ([&quot;name&quot;: &quot;Alice&quot;, &quot;age&quot;: 30, &quot;scores&quot;: ({90, 85, 95})]),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ([&quot;name&quot;: &quot;Bob&quot;, &quot;age&quot;: 25, &quot;scores&quot;: ({80, 75, 85})])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;settings&quot;: ([</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;theme&quot;: &quot;dark&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;language&quot;: &quot;en&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;autosave&quot;: true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Save and load</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">save_data(app_data, DATA_FILE);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapping(string:mixed) loaded = load_data(DATA_FILE);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Loaded version: %s\n&quot;, loaded[&quot;version&quot;]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Loaded users: %d\n&quot;, sizeof(loaded[&quot;users&quot;]));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Encode with codec for custom object support</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mixed save_with_codec(mixed data) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Use default codec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return encode_value(data, Codec());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mixed load_with_codec(string data) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return decode_value(data, Codec());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Incremental saves using History ADT</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import ADT.History;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class HistoryStore {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private History _history = History();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private string _filename;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void create(string filename) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _filename = filename;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void save(mixed data) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _history-&gt;push_history(deep_copy(data));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        save_data(_history-&gt;current(), _filename);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    mixed|zero load() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        mixed data = load_data(_filename);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _history-&gt;push_history(data);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return data;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    mixed|zero undo() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return _history-&gt;pop_history();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private mixed deep_copy(mixed data) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (arrayp(data)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return map(data, deep_copy);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } else if (mappingp(data)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            mapping(mixed:mixed) result = ([]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            foreach (data; mixed k; mixed v) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                result[deep_copy(k)] = deep_copy(v);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return result;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return data;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="transparently-persistent-data-structures">Transparently Persistent Data Structures<a href="#transparently-persistent-data-structures" class="hash-link" aria-label="Direct link to Transparently Persistent Data Structures" title="Direct link to Transparently Persistent Data Structures" translate="no">​</a></h2>
<p>Implement transparent persistence with automatic loading and saving. Use getter/setter functions to manage persistence.</p>
<div class="language-pike codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-pike codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pike 8 - Transparently persistent data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#pragma strict_types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class PersistentMap {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private mapping(string:mixed) _data = ([]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private string _filename;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private bool _dirty = false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void create(string filename) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _filename = filename;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        load();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void load() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (Stdio.file_size(_filename) &gt; 0) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            mixed decoded = decode_value(Stdio.read_file(_filename));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if (mappingp(decoded)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                _data = decoded;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _dirty = false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void save() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (_dirty) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Stdio.write_file(_filename, encode_value(_data));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _dirty = false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    mixed `[](string key) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return _data[key];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void `[]=(string key, mixed value) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _data[key] = value;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _dirty = true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    array(string) _indices() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return indices(_data);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    array(mixed) _values() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return values(_data);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void destroy() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        save();  // Auto-save on destruction</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Usage</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PersistentMap store = PersistentMap(&quot;persistent.dat&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">store[&quot;username&quot;] = &quot;alice&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">store[&quot;login_count&quot;] = 5;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">store-&gt;save();  // Explicit save</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Later session</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PersistentMap store2 = PersistentMap(&quot;persistent.dat&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Username: %s\n&quot;, store2[&quot;username&quot;]);       // Output: alice</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Logins: %d\n&quot;, store2[&quot;login_count&quot;]);      // Output: 5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Persistent cache with TTL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class PersistentCache {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private mapping(string:mapping) _cache = ([]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private string _filename;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private int _default_ttl = 3600;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void create(string filename, int|void default_ttl) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _filename = filename;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (default_ttl) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _default_ttl = default_ttl;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        load();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void set(string key, mixed value, int|void ttl) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ttl = ttl || _default_ttl;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _cache[key] = ([</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;value&quot;: value,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;expires&quot;: time() + ttl</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        flush();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    mixed|zero get(string key) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (!_cache[key]) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return UNDEFINED;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        mapping entry = _cache[key];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (entry[&quot;expires&quot;] &lt; time()) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // Expired</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            m_delete(_cache, key);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            flush();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return UNDEFINED;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return entry[&quot;value&quot;];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void flush() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Stdio.write_file(_filename, encode_value(_cache));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void load() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (Stdio.file_size(_filename) &gt; 0) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            mixed data = decode_value(Stdio.read_file(_filename));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if (mappingp(data)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                _cache = data;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                // Clean expired entries</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                cleanup_expired();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void cleanup_expired() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        int now = time();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        foreach (indices(_cache), string key) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if (_cache[key][&quot;expires&quot;] &lt; now) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                m_delete(_cache, key);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        flush();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="program-binary-trees">Program: Binary Trees<a href="#program-binary-trees" class="hash-link" aria-label="Direct link to Program: Binary Trees" title="Direct link to Program: Binary Trees" translate="no">​</a></h2>
<p>Implement a binary search tree in Pike using classes and proper memory management.</p>
<div class="language-pike codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-pike codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Pike 8 - Binary Search Tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#pragma strict_types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class TreeNode {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    mixed value;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    TreeNode|zero left;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    TreeNode|zero right;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void create(mixed v) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        value = v;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        left = UNDEFINED;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        right = UNDEFINED;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class BinarySearchTree {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private TreeNode|zero _root = UNDEFINED;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void insert(mixed value) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _root = _insert(_root, value);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private TreeNode _insert(TreeNode|zero node, mixed value) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (!node) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return TreeNode(value);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (value &lt; node-&gt;value) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            node-&gt;left = _insert(node-&gt;left, value);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } else if (value &gt; node-&gt;value) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            node-&gt;right = _insert(node-&gt;right, value);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // If equal, don&#x27;t insert duplicates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return node;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bool contains(mixed value) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return _contains(_root, value);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private bool _contains(TreeNode|zero node, mixed value) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (!node) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (value == node-&gt;value) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } else if (value &lt; node-&gt;value) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return _contains(node-&gt;left, value);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return _contains(node-&gt;right, value);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    array(mixed) inorder() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        array(mixed) result = ({});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _inorder(_root, result);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return result;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private void _inorder(TreeNode|zero node, array(mixed) result) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (node) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _inorder(node-&gt;left, result);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            result += ({node-&gt;value});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _inorder(node-&gt;right, result);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int get_depth() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return _depth(_root);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private int _depth(TreeNode|zero node) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (!node) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return 0;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return 1 + max(_depth(node-&gt;left), _depth(node-&gt;right));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int get_size() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return _size(_root);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private int _size(TreeNode|zero node) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (!node) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return 0;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return 1 + _size(node-&gt;left) + _size(node-&gt;right);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    void pretty_print() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _print(_root, 0, &quot;Root: &quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private void _print(TreeNode|zero node, int level, string prefix) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (node) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            write(&quot;%s%s\n&quot;, &quot;  &quot; * level + prefix, node-&gt;value);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _print(node-&gt;left, level + 1, &quot;L--- &quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _print(node-&gt;right, level + 1, &quot;R--- &quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Usage example</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BinarySearchTree bst = BinarySearchTree();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">array(int) values = ({50, 30, 70, 20, 40, 60, 80});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">foreach (values, int val) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bst-&gt;insert(val);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;BST Structure:\n&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bst-&gt;pretty_print();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;\nInorder traversal: %s\n&quot;, bst-&gt;inorder() * &quot;, &quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Depth: %d\n&quot;, bst-&gt;get_depth());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Size: %d\n&quot;, bst-&gt;get_size());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;\nSearch tests:\n&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">foreach (({20, 40, 60, 99}), int val) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    write(&quot;Contains %d: %s\n&quot;, val, bst-&gt;contains(val) ? &quot;yes&quot; : &quot;no&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Serialize/deserialize BST</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">string serialize_tree(BinarySearchTree tree) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return encode_value(tree-&gt;inorder());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BinarySearchTree deserialize_tree(string data) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    array(int) values = decode_value(data);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    BinarySearchTree tree = BinarySearchTree();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    foreach (values, int val) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        tree-&gt;insert(val);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return tree;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Test serialization</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;\nSerialization test:\n&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">string serialized = serialize_tree(bst);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BinarySearchTree restored = deserialize_tree(serialized);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write(&quot;Restored inorder: %s\n&quot;, restored-&gt;inorder() * &quot;, &quot;);</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/smuks/pike-cookbook/tree/main/docs/advanced/references.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/pike-cookbook/docs/advanced/classes"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Classes and Objects</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/pike-cookbook/docs/advanced/modules"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Modules and Packages</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#taking-references-to-arrays" class="table-of-contents__link toc-highlight">Taking References to Arrays</a></li><li><a href="#making-hashes-of-arrays" class="table-of-contents__link toc-highlight">Making Hashes of Arrays</a></li><li><a href="#taking-references-to-hashes" class="table-of-contents__link toc-highlight">Taking References to Hashes</a></li><li><a href="#taking-references-to-functions" class="table-of-contents__link toc-highlight">Taking References to Functions</a></li><li><a href="#taking-references-to-scalars" class="table-of-contents__link toc-highlight">Taking References to Scalars</a></li><li><a href="#creating-arrays-of-scalar-references" class="table-of-contents__link toc-highlight">Creating Arrays of Scalar References</a></li><li><a href="#using-closures-instead-of-objects" class="table-of-contents__link toc-highlight">Using Closures Instead of Objects</a></li><li><a href="#creating-references-to-methods" class="table-of-contents__link toc-highlight">Creating References to Methods</a></li><li><a href="#constructing-records" class="table-of-contents__link toc-highlight">Constructing Records</a></li><li><a href="#reading-and-writing-hash-records-to-text-files" class="table-of-contents__link toc-highlight">Reading and Writing Hash Records to Text Files</a></li><li><a href="#printing-data-structures" class="table-of-contents__link toc-highlight">Printing Data Structures</a></li><li><a href="#copying-data-structures" class="table-of-contents__link toc-highlight">Copying Data Structures</a></li><li><a href="#storing-data-structures-to-disk" class="table-of-contents__link toc-highlight">Storing Data Structures to Disk</a></li><li><a href="#transparently-persistent-data-structures" class="table-of-contents__link toc-highlight">Transparently Persistent Data Structures</a></li><li><a href="#program-binary-trees" class="table-of-contents__link toc-highlight">Program: Binary Trees</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/pike-cookbook/docs/intro">Cookbook</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/smuks/pike-cookbook" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://pike.lysator.liu.se/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Pike Homepage<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>